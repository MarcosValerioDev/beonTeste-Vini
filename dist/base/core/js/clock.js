(()=>{var t={178:t=>{const e=function(t,e){for(var i=e.split(","),n=t.className,o=0;o<i.length;o++){var s=i[o];n=n.indexOf(s)<0?n+" "+s:n}t.className=n},i=function(t,e){for(var i=e.split(","),n=t.className,o=0;o<i.length;o++){var s=new RegExp(i[o],"im");n=n.replace(s,"")}t.className=n};t.exports={hasClass:function(t,e){return new RegExp(e+"\b","im").test(t.className)},addClass:e,removeClass:i,display:function(t,n){i(t,"bn--block, bn--flex, bn--grid, bn--hide, bn--none"),e(t,"bn--"+n)}}}},e={};function i(n){if(e[n])return e[n].exports;var o=e[n]={exports:{}};return t[n](o,o.exports,i),o.exports}(()=>{"use strict";var t=i(178),e=function(t,e){return this.root=t,this.options={tick:!1,ended:!1,urgent:!1,live:!1},this.config=Object.assign({type:"dates",interval:null,start_date:null,end_date:null,urgent_date:null,headline:"",support_text:"",hideOnEnd:!1,aggregateDays:!1},e),this.dates={now:null,start:null,end:null,urgent:null},this.fragments={d:null,H:null,i:null,s:null},this.interval=null,this.init(),this};e.prototype.init=function(){t.addClass(this.root,"initialized"),this.initDates(),this.initFragments(),this.initClock(),this.start()},e.prototype.initDates=function(){if(this.dates.now=new Date,"dates"===this.config.type&&(this.dates.start=new Date(this.config.start_date),this.dates.end=new Date(this.config.end_date),this.dates.urgent=new Date(this.config.urgent_date)),"relative"===this.config.type){var t=new Date;t.setHours(0),t.setMinutes(0),t.setSeconds(0);var e=new Date;e.setHours(23),e.setMinutes(59),e.setSeconds(59),this.dates.start=new Date(t),this.dates.end=new Date(e),this.dates.urgent=new Date(e)}if("interval"===this.config.type&&this.config.interval){var i,n,o=["bn",this.root.id].join("-"),s=("; "+document.cookie).split(o+"="),a=2===s.length?s.pop().split(";").shift():null;if(a){var r=a.split("/");i=new Date(parseInt(r[0],10)),n=new Date(parseInt(r[1],10))}else i=new Date,n=new Date(Date.now()+60*this.config.interval*1e3),document.cookie=o+"="+[i.getTime(),n.getTime()].join("/")+"; SameSite=Lax; path=/";this.dates.start=new Date(i),this.dates.end=new Date(n),this.dates.urgent=new Date(n)}this.options.live=!0,this.notStartedYet()?(this.options.tick=!1,this.options.live=!1,this.hideAssociate("not-started"),this.hide()):this.limitReached()&&(this.options.tick=!1,this.options.ended=!0,this.hideOnEnd())},e.prototype.initFragments=function(){this.fragments={d:this.root.querySelector(".beon-clock__fragment-d, .bn-clock__frag-d"),H:this.root.querySelector(".beon-clock__fragment-H, .bn-clock__frag-H"),i:this.root.querySelector(".beon-clock__fragment-i, .bn-clock__frag-i"),s:this.root.querySelector(".beon-clock__fragment-s, .bn-clock__frag-s")},this.config.aggregateDays&&(t.addClass(this.root,"beon-clock--without-days"),this.fragments.d.style.display="none")},e.prototype.initClock=function(){this.updateFragments()},e.prototype.diff=function(t,e){var i,n,o;return o={d:0,H:0,i:0,s:0},this.limitReached()?(this.end(),this.dates.diff=o,o):((i=t.getTime()-e.getTime())>0&&(n=i/1e3,o.d=Math.floor(n/86400),o.H=Math.floor((n-86400*o.d)/3600),o.i=Math.floor((n-86400*o.d-3600*o.H)/60),o.s=Math.floor(n-86400*o.d-3600*o.H-60*o.i),this.config.aggregateDays&&(o.H=o.H+24*o.d,o.d=0)),this.dates.diff=o,o)},e.prototype.notStartedYet=function(){var t=this.dates.now.getTime()/1e3+100;return this.dates.start.getTime()/1e3>t},e.prototype.limitReached=function(){return this.dates.now.getTime()>this.dates.end.getTime()},e.prototype.updateNow=function(){this.dates.now=new Date},e.prototype.urgentReached=function(){return this.dates.urgent?this.dates.now.getTime()>this.dates.urgent.getTime():0},e.prototype.updateFragments=function(){for(var t=Object.entries(this.diff(this.dates.end,this.dates.now)),e=0;e<t.length;e++){var[i,n]=t[e];this.setFragment(i,n)}},e.prototype.setFragment=function(t,e){var i;i=this.config.aggregateDays&&"H"===t||!this.config.aggregateDays&&"d"===t?e.toString().length<=2?this.pad(e,2,"0"):e:this.pad(e,2,"0"),this.fragments[t].innerText=i},e.prototype.tick=function(){if(!this.options.tick)return this.stop();this.updateNow(),this.updateFragments(),!this.options.urgent&&this.urgentReached()&&this.urgent(),this.limitReached()&&this.end()},e.prototype.start=function(){if(!this.options.live)return this.stop();this.interval=window.setInterval(this.tick.bind(this),1e3),this.options.tick=!0},e.prototype.stop=function(){window.clearInterval(this.interval),this.options.tick=!1},e.prototype.end=function(){this.stop(),this.ended=!0,t.addClass(this.root,"ended"),this.hideOnEnd()},e.prototype.urgent=function(){this.options.urgent=!0,t.addClass(this.root,"urgent")},e.prototype.hideOnEnd=function(){this.ended&&this.config.hideOnEnd&&(this.hideAssociate("ended"),this.hide(),t.addClass(this.root,"bn--clock-ended"))},e.prototype.getAssociate=function(){var t=this.root.getAttribute("data-associate-id"),e=t?document.getElementById(t):null;return this.associate=e,this.associate},e.prototype.hasAssociate=function(){return this.getAssociate(),!!this.associate},e.prototype.hideAssociate=function(e){e=e||"not-started",this.hasAssociate()&&(this.hide(this.getAssociate()),t.addClass(this.getAssociate(),"bn--clock-"+e))},e.prototype.hide=function(e){var i=e||this.root;t.display(i,"none")},e.prototype.pad=function(t,e,i){return e=t.length>e?t.pength:e,(t=i.repeat(e)+t).substr(t.length-e)};const n=e;var o=function(){this.componentRootSelector=".beon-clock",this.initComponents(),this.bindEvents()};o.prototype.bindEvents=function(){document.addEventListener("DOMContentLoaded",this.initComponents.bind(this)),document.addEventListener("beon.buddy.elements.handle.item.inject.success",this.initComponentFromInjection.bind(this)),document.addEventListener("beon.buddy.inject.after",this.initComponentFromInjection.bind(this))},o.prototype.initComponents=function(){var t=document.querySelectorAll(this.componentRootSelector+":not(.initialized)");Array.prototype.slice.call(t).forEach(function(t){this.initComponent(t)}.bind(this))},o.prototype.initComponentFromInjection=function(t){var e=t.detail.container.querySelector(this.componentRootSelector+":not(.initialized)");e&&("loading"===document.readyState?document.addEventListener("DOMContentLoaded",function(){this.initComponent(e)}.bind(this)):this.initComponent(e))},o.prototype.initComponent=function(t){try{window.beon_init_log=window.beon_init_log||[];var e=t.getAttribute("data-config"),i=(t.id,JSON.parse(e));new n(t,i)}catch(t){console.log("failed to build component "+this.componentRootSelector,t)}},window&&(window.BeonClockInitializer=o)})()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9ibi50ZW5hbnQuY3VzdG9tLmJhc2UvLi9zcmMvYmFzZS9zcmMvanMvaGVscGVycy9kb20uanMiLCJ3ZWJwYWNrOi8vYm4udGVuYW50LmN1c3RvbS5iYXNlL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL2JuLnRlbmFudC5jdXN0b20uYmFzZS8uL3NyYy9iYXNlL3NyYy9qcy9jbG9jay9jbG9jay5qcyIsIndlYnBhY2s6Ly9ibi50ZW5hbnQuY3VzdG9tLmJhc2UvLi9zcmMvYmFzZS9zcmMvanMvY2xvY2svaW5pdC5qcyJdLCJuYW1lcyI6WyJhZGRDbGFzcyIsImVsIiwiY2xhc3NMaXN0IiwiY2xhc3NlcyIsInNwbGl0IiwiY2xhc3NOYW1lIiwiaSIsImxlbmd0aCIsImN1cnJlbnQiLCJpbmRleE9mIiwicmVtb3ZlQ2xhc3MiLCJSZWdFeHAiLCJyZXBsYWNlIiwibW9kdWxlIiwiZXhwb3J0cyIsImhhc0NsYXNzIiwidGVzdCIsImRpc3BsYXkiLCJ2YWx1ZSIsIl9fd2VicGFja19tb2R1bGVfY2FjaGVfXyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsIl9fd2VicGFja19tb2R1bGVzX18iLCJkb20iLCJDbG9ja0NvbXBvbmVudCIsInJvb3QiLCJjb25maWciLCJ0aGlzIiwib3B0aW9ucyIsInRpY2siLCJlbmRlZCIsInVyZ2VudCIsImxpdmUiLCJPYmplY3QiLCJhc3NpZ24iLCJ0eXBlIiwiaW50ZXJ2YWwiLCJzdGFydF9kYXRlIiwiZW5kX2RhdGUiLCJ1cmdlbnRfZGF0ZSIsImhlYWRsaW5lIiwic3VwcG9ydF90ZXh0IiwiaGlkZU9uRW5kIiwiYWdncmVnYXRlRGF5cyIsImRhdGVzIiwibm93Iiwic3RhcnQiLCJlbmQiLCJmcmFnbWVudHMiLCJkIiwiSCIsInMiLCJpbml0IiwicHJvdG90eXBlIiwiaW5pdERhdGVzIiwiaW5pdEZyYWdtZW50cyIsImluaXRDbG9jayIsIkRhdGUiLCJkYXlTdGFydCIsInNldEhvdXJzIiwic2V0TWludXRlcyIsInNldFNlY29uZHMiLCJkYXlFbmQiLCJzdGFydERhdGUiLCJlbmREYXRlIiwiZGF0ZXNDb29raWVOYW1lIiwiaWQiLCJqb2luIiwiZGF0ZXNDb29raWVQYXJ0cyIsImRvY3VtZW50IiwiY29va2llIiwiZGF0ZXNDb29raWVWYWx1ZSIsInBvcCIsInNoaWZ0IiwiY29va2llRGF0ZXMiLCJwYXJzZUludCIsImdldFRpbWUiLCJub3RTdGFydGVkWWV0IiwiaGlkZUFzc29jaWF0ZSIsImhpZGUiLCJsaW1pdFJlYWNoZWQiLCJxdWVyeVNlbGVjdG9yIiwic3R5bGUiLCJ1cGRhdGVGcmFnbWVudHMiLCJkaWZmIiwiZDEiLCJkMiIsIm1pbGlzZWNvbmRzIiwic2Vjb25kcyIsIk1hdGgiLCJmbG9vciIsInVwZGF0ZU5vdyIsInVyZ2VudFJlYWNoZWQiLCJlbnRyaWVzIiwiZnJhZyIsInNldEZyYWdtZW50IiwiZm9ybWF0dGVkIiwidG9TdHJpbmciLCJwYWQiLCJpbm5lclRleHQiLCJzdG9wIiwid2luZG93Iiwic2V0SW50ZXJ2YWwiLCJiaW5kIiwiY2xlYXJJbnRlcnZhbCIsImdldEFzc29jaWF0ZSIsImFzc29jaWF0ZUlkIiwiZ2V0QXR0cmlidXRlIiwiYXNzb2NpYXRlRWwiLCJnZXRFbGVtZW50QnlJZCIsImFzc29jaWF0ZSIsImhhc0Fzc29jaWF0ZSIsInJlYXNvbiIsImVsVG9IaWRlIiwic3RyIiwic2l6ZSIsInBhZGRpbmciLCJwZW5ndGgiLCJyZXBlYXQiLCJzdWJzdHIiLCJDbG9ja0luaXRpYWxpemVyIiwiY29tcG9uZW50Um9vdFNlbGVjdG9yIiwiaW5pdENvbXBvbmVudHMiLCJiaW5kRXZlbnRzIiwiYWRkRXZlbnRMaXN0ZW5lciIsImluaXRDb21wb25lbnRGcm9tSW5qZWN0aW9uIiwiY29tcG9uZW50cyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJBcnJheSIsInNsaWNlIiwiY2FsbCIsImZvckVhY2giLCJpbml0Q29tcG9uZW50IiwiZXZlbnQiLCJkZXRhaWwiLCJjb250YWluZXIiLCJyZWFkeVN0YXRlIiwiYmVvbl9pbml0X2xvZyIsInJhd0NvbmZpZyIsIkpTT04iLCJwYXJzZSIsImUiLCJjb25zb2xlIiwibG9nIiwiQmVvbkNsb2NrSW5pdGlhbGl6ZXIiXSwibWFwcGluZ3MiOiJxQkFBQSxNQUtNQSxFQUFXLFNBQVVDLEVBQUlDLEdBSTdCLElBSEEsSUFBSUMsRUFBVUQsRUFBVUUsTUFBTSxLQUMxQkMsRUFBWUosRUFBR0ksVUFFVkMsRUFBSSxFQUFHQSxFQUFJSCxFQUFRSSxPQUFRRCxJQUFLLENBQ3ZDLElBQUlFLEVBQVVMLEVBQVFHLEdBQ3RCRCxFQUNFQSxFQUFVSSxRQUFRRCxHQUFXLEVBQUlILEVBQVksSUFBTUcsRUFBVUgsRUFHakVKLEVBQUdJLFVBQVlBLEdBR1hLLEVBQWMsU0FBVVQsRUFBSUMsR0FJaEMsSUFIQSxJQUFJQyxFQUFVRCxFQUFVRSxNQUFNLEtBQzFCQyxFQUFZSixFQUFHSSxVQUVWQyxFQUFJLEVBQUdBLEVBQUlILEVBQVFJLE9BQVFELElBQUssQ0FDdkMsSUFBSUUsRUFBVSxJQUFJRyxPQUFPUixFQUFRRyxHQUFJLE1BQ3JDRCxFQUFZQSxFQUFVTyxRQUFRSixFQUFTLElBR3pDUCxFQUFHSSxVQUFZQSxHQVFqQlEsRUFBT0MsUUFBVSxDQUFFQyxTQW5DRixTQUFVZCxFQUFJSSxHQUU3QixPQURZLElBQUlNLE9BQU9OLEVBQVksS0FBTSxNQUM1QlcsS0FBS2YsRUFBR0ksWUFpQ01MLFdBQVVVLGNBQWFPLFFBTHBDLFNBQVVoQixFQUFJaUIsR0FDNUJSLEVBQVlULEVBQUkscURBQ2hCRCxFQUFTQyxFQUFJLE9BQVNpQixPQy9CcEJDLEVBQTJCLEdBRy9CLFNBQVNDLEVBQW9CQyxHQUU1QixHQUFHRixFQUF5QkUsR0FDM0IsT0FBT0YsRUFBeUJFLEdBQVVQLFFBRzNDLElBQUlELEVBQVNNLEVBQXlCRSxHQUFZLENBR2pEUCxRQUFTLElBT1YsT0FIQVEsRUFBb0JELEdBQVVSLEVBQVFBLEVBQU9DLFFBQVNNLEdBRy9DUCxFQUFPQyxRLG1CQ3BCZixJ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LEtBQUt5RyxjQUFjM0csSUFDbkI4RSxLQUFLNUUsUUFJWDZGLEVBQWlCbkUsVUFBVXdFLDJCQUE2QixTQUFVUSxHQUNoRSxJQUNJNUcsRUFEWTRHLEVBQU1DLE9BQU9DLFVBQ1J0RCxjQUNuQnRELEtBQUs4RixzQkFBd0Isc0JBRzNCaEcsSUFDMEIsWUFBeEI0QyxTQUFTbUUsV0FDWG5FLFNBQVN1RCxpQkFDUCxtQkFDQSxXQUNFakcsS0FBS3lHLGNBQWMzRyxJQUNuQjhFLEtBQUs1RSxPQUdUQSxLQUFLeUcsY0FBYzNHLEtBS3pCK0YsRUFBaUJuRSxVQUFVK0UsY0FBZ0IsU0FBVTNHLEdBQ25ELElBQ0U0RSxPQUFPb0MsY0FBZ0JwQyxPQUFPb0MsZUFBaUIsR0FFL0MsSUFBSUMsRUFBWWpILEVBQUtrRixhQUFhLGVBRTlCakYsR0FEU0QsRUFBS3lDLEdBQ0x5RSxLQUFLQyxNQUFNRixJQVN4QixJQUFJLEVBQWVqSCxFQUFNQyxHQUN6QixNQUFPbUgsR0FDUEMsUUFBUUMsSUFBSSw2QkFBK0JwSCxLQUFLOEYsc0JBQXVCb0IsS0FLckV4QyxTQUFRQSxPQUFPMkMscUJBQXVCeEIsSSIsImZpbGUiOiJiYXNlL2NvcmUvanMvY2xvY2suanMiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBoYXNDbGFzcyA9IGZ1bmN0aW9uIChlbCwgY2xhc3NOYW1lKSB7XG4gIHZhciByZWdleCA9IG5ldyBSZWdFeHAoY2xhc3NOYW1lICsgXCJcXGJcIiwgXCJpbVwiKTtcbiAgcmV0dXJuIHJlZ2V4LnRlc3QoZWwuY2xhc3NOYW1lKTtcbn07XG5cbmNvbnN0IGFkZENsYXNzID0gZnVuY3Rpb24gKGVsLCBjbGFzc0xpc3QpIHtcbiAgdmFyIGNsYXNzZXMgPSBjbGFzc0xpc3Quc3BsaXQoXCIsXCIpO1xuICB2YXIgY2xhc3NOYW1lID0gZWwuY2xhc3NOYW1lO1xuXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgY2xhc3Nlcy5sZW5ndGg7IGkrKykge1xuICAgIHZhciBjdXJyZW50ID0gY2xhc3Nlc1tpXTtcbiAgICBjbGFzc05hbWUgPVxuICAgICAgY2xhc3NOYW1lLmluZGV4T2YoY3VycmVudCkgPCAwID8gY2xhc3NOYW1lICsgXCIgXCIgKyBjdXJyZW50IDogY2xhc3NOYW1lO1xuICB9XG5cbiAgZWwuY2xhc3NOYW1lID0gY2xhc3NOYW1lO1xufTtcblxuY29uc3QgcmVtb3ZlQ2xhc3MgPSBmdW5jdGlvbiAoZWwsIGNsYXNzTGlzdCkge1xuICB2YXIgY2xhc3NlcyA9IGNsYXNzTGlzdC5zcGxpdChcIixcIik7XG4gIHZhciBjbGFzc05hbWUgPSBlbC5jbGFzc05hbWU7XG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBjbGFzc2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgdmFyIGN1cnJlbnQgPSBuZXcgUmVnRXhwKGNsYXNzZXNbaV0sIFwiaW1cIik7XG4gICAgY2xhc3NOYW1lID0gY2xhc3NOYW1lLnJlcGxhY2UoY3VycmVudCwgXCJcIik7XG4gIH1cblxuICBlbC5jbGFzc05hbWUgPSBjbGFzc05hbWU7XG59O1xuXG5jb25zdCBkaXNwbGF5ID0gZnVuY3Rpb24gKGVsLCB2YWx1ZSkge1xuICByZW1vdmVDbGFzcyhlbCwgXCJibi0tYmxvY2ssIGJuLS1mbGV4LCBibi0tZ3JpZCwgYm4tLWhpZGUsIGJuLS1ub25lXCIpO1xuICBhZGRDbGFzcyhlbCwgXCJibi0tXCIgKyB2YWx1ZSk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IHsgaGFzQ2xhc3MsIGFkZENsYXNzLCByZW1vdmVDbGFzcywgZGlzcGxheSB9O1xuIiwiLy8gVGhlIG1vZHVsZSBjYWNoZVxudmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9O1xuXG4vLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcblx0aWYoX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSkge1xuXHRcdHJldHVybiBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdLmV4cG9ydHM7XG5cdH1cblx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcblx0dmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7XG5cdFx0Ly8gbm8gbW9kdWxlLmlkIG5lZWRlZFxuXHRcdC8vIG5vIG1vZHVsZS5sb2FkZWQgbmVlZGVkXG5cdFx0ZXhwb3J0czoge31cblx0fTtcblxuXHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cblx0X193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0obW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cblx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcblx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xufVxuXG4iLCJ2YXIgZG9tID0gcmVxdWlyZShcIi4uL2hlbHBlcnMvZG9tLmpzXCIpO1xuXG52YXIgQ2xvY2tDb21wb25lbnQgPSBmdW5jdGlvbiAocm9vdCwgY29uZmlnKSB7XG4gIHRoaXMucm9vdCA9IHJvb3Q7XG5cbiAgdGhpcy5vcHRpb25zID0ge1xuICAgIHRpY2s6IGZhbHNlLCAvLyBpbmRpY2F0ZXMgdGhhdCBjbG9jayBpcyB0aWNraW5nXG4gICAgZW5kZWQ6IGZhbHNlLCAvLyBpbmRpY2F0ZXMgd2hlbiBjbG9jayBoYXMgZW5kZWRcbiAgICB1cmdlbnQ6IGZhbHNlLCAvLyBpbmRpY2F0ZXMgd2hlbiBjbG9jayByZWNoZWQgdXJnZW50IGxpbWl0XG4gICAgbGl2ZTogZmFsc2UsIC8vIGluZGljYXRlcyBpZiBjbG9jayBpcyBsaXZlXG4gIH07XG5cbiAgdGhpcy5jb25maWcgPSBPYmplY3QuYXNzaWduKFxuICAgIHtcbiAgICAgIHR5cGU6IFwiZGF0ZXNcIixcbiAgICAgIGludGVydmFsOiBudWxsLFxuICAgICAgc3RhcnRfZGF0ZTogbnVsbCxcbiAgICAgIGVuZF9kYXRlOiBudWxsLFxuICAgICAgdXJnZW50X2RhdGU6IG51bGwsXG4gICAgICBoZWFkbGluZTogXCJcIixcbiAgICAgIHN1cHBvcnRfdGV4dDogXCJcIixcbiAgICAgIGhpZGVPbkVuZDogZmFsc2UsXG4gICAgICBhZ2dyZWdhdGVEYXlzOiBmYWxzZSxcbiAgICB9LFxuICAgIGNvbmZpZ1xuICApO1xuXG4gIHRoaXMuZGF0ZXMgPSB7XG4gICAgbm93OiBudWxsLFxuICAgIHN0YXJ0OiBudWxsLFxuICAgIGVuZDogbnVsbCxcbiAgICB1cmdlbnQ6IG51bGwsXG4gIH07XG5cbiAgdGhpcy5mcmFnbWVudHMgPSB7XG4gICAgZDogbnVsbCxcbiAgICBIOiBudWxsLFxuICAgIGk6IG51bGwsXG4gICAgczogbnVsbCxcbiAgfTtcblxuICB0aGlzLmludGVydmFsID0gbnVsbDtcblxuICB0aGlzLmluaXQoKTtcblxuICByZXR1cm4gdGhpcztcbn07XG5cbkNsb2NrQ29tcG9uZW50LnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24gKCkge1xuICBkb20uYWRkQ2xhc3ModGhpcy5yb290LCBcImluaXRpYWxpemVkXCIpO1xuXG4gIHRoaXMuaW5pdERhdGVzKCk7XG4gIHRoaXMuaW5pdEZyYWdtZW50cygpO1xuICB0aGlzLmluaXRDbG9jaygpO1xuICB0aGlzLnN0YXJ0KCk7XG59O1xuXG5DbG9ja0NvbXBvbmVudC5wcm90b3R5cGUuaW5pdERhdGVzID0gZnVuY3Rpb24gKCkge1xuICB0aGlzLmRhdGVzLm5vdyA9IG5ldyBEYXRlKCk7XG5cbiAgLy8gaWYgc3RhcnQgZGF0ZSBpcyBkZWZpbmVkXG4gIGlmICh0aGlzLmNvbmZpZy50eXBlID09PSBcImRhdGVzXCIpIHtcbiAgICB0aGlzLmRhdGVzLnN0YXJ0ID0gbmV3IERhdGUodGhpcy5jb25maWcuc3RhcnRfZGF0ZSk7XG4gICAgdGhpcy5kYXRlcy5lbmQgPSBuZXcgRGF0ZSh0aGlzLmNvbmZpZy5lbmRfZGF0ZSk7XG4gICAgdGhpcy5kYXRlcy51cmdlbnQgPSBuZXcgRGF0ZSh0aGlzLmNvbmZpZy51cmdlbnRfZGF0ZSk7XG4gIH1cblxuICAvLyByZWxhdGl2ZSBkYXRlc1xuICBpZiAodGhpcy5jb25maWcudHlwZSA9PT0gXCJyZWxhdGl2ZVwiKSB7XG4gICAgLy8gY3VycmVudCBzdXBwb3J0OiB0b2RheVxuICAgIHZhciBkYXlTdGFydCA9IG5ldyBEYXRlKCk7XG4gICAgZGF5U3RhcnQuc2V0SG91cnMoMCk7XG4gICAgZGF5U3RhcnQuc2V0TWludXRlcygwKTtcbiAgICBkYXlTdGFydC5zZXRTZWNvbmRzKDApO1xuXG4gICAgdmFyIGRheUVuZCA9IG5ldyBEYXRlKCk7XG4gICAgZGF5RW5kLnNldEhvdXJzKDIzKTtcbiAgICBkYXlFbmQuc2V0TWludXRlcyg1OSk7XG4gICAgZGF5RW5kLnNldFNlY29uZHMoNTkpO1xuXG4gICAgdGhpcy5kYXRlcy5zdGFydCA9IG5ldyBEYXRlKGRheVN0YXJ0KTtcbiAgICB0aGlzLmRhdGVzLmVuZCA9IG5ldyBEYXRlKGRheUVuZCk7XG4gICAgdGhpcy5kYXRlcy51cmdlbnQgPSBuZXcgRGF0ZShkYXlFbmQpO1xuICB9XG5cbiAgLy8gaWYgaW50ZXJ2YWwgY2xvY2tcbiAgaWYgKHRoaXMuY29uZmlnLnR5cGUgPT09IFwiaW50ZXJ2YWxcIiAmJiB0aGlzLmNvbmZpZy5pbnRlcnZhbCkge1xuICAgIC8vIGxvYWQgY29va2llIHdpdGggZGVmaW5lZCBkYXRlcyBmb3IgdGhpcyB1c2VyXG4gICAgdmFyIGRhdGVzQ29va2llTmFtZSA9IFtcImJuXCIsIHRoaXMucm9vdC5pZF0uam9pbihcIi1cIik7XG5cbiAgICB2YXIgZGF0ZXNDb29raWVQYXJ0cyA9IChcIjsgXCIgKyBkb2N1bWVudC5jb29raWUpLnNwbGl0KFxuICAgICAgZGF0ZXNDb29raWVOYW1lICsgXCI9XCJcbiAgICApO1xuXG4gICAgdmFyIGRhdGVzQ29va2llVmFsdWUgPVxuICAgICAgZGF0ZXNDb29raWVQYXJ0cy5sZW5ndGggPT09IDJcbiAgICAgICAgPyBkYXRlc0Nvb2tpZVBhcnRzLnBvcCgpLnNwbGl0KFwiO1wiKS5zaGlmdCgpXG4gICAgICAgIDogbnVsbDtcblxuICAgIHZhciBzdGFydERhdGUsIGVuZERhdGU7XG5cbiAgICBpZiAoZGF0ZXNDb29raWVWYWx1ZSkge1xuICAgICAgdmFyIGNvb2tpZURhdGVzID0gZGF0ZXNDb29raWVWYWx1ZS5zcGxpdChcIi9cIik7XG5cbiAgICAgIHN0YXJ0RGF0ZSA9IG5ldyBEYXRlKHBhcnNlSW50KGNvb2tpZURhdGVzWzBdLCAxMCkpO1xuICAgICAgZW5kRGF0ZSA9IG5ldyBEYXRlKHBhcnNlSW50KGNvb2tpZURhdGVzWzFdLCAxMCkpO1xuICAgIH0gZWxzZSB7XG4gICAgICBzdGFydERhdGUgPSBuZXcgRGF0ZSgpO1xuICAgICAgZW5kRGF0ZSA9IG5ldyBEYXRlKERhdGUubm93KCkgKyB0aGlzLmNvbmZpZy5pbnRlcnZhbCAqIDYwICogMTAwMCk7XG5cbiAgICAgIGRvY3VtZW50LmNvb2tpZSA9XG4gICAgICAgIGRhdGVzQ29va2llTmFtZSArXG4gICAgICAgIFwiPVwiICtcbiAgICAgICAgW3N0YXJ0RGF0ZS5nZXRUaW1lKCksIGVuZERhdGUuZ2V0VGltZSgpXS5qb2luKFwiL1wiKSArXG4gICAgICAgIFwiOyBTYW1lU2l0ZT1MYXg7IHBhdGg9L1wiO1xuICAgIH1cblxuICAgIHRoaXMuZGF0ZXMuc3RhcnQgPSBuZXcgRGF0ZShzdGFydERhdGUpO1xuICAgIHRoaXMuZGF0ZXMuZW5kID0gbmV3IERhdGUoZW5kRGF0ZSk7XG4gICAgdGhpcy5kYXRlcy51cmdlbnQgPSBuZXcgRGF0ZShlbmREYXRlKTtcbiAgfVxuXG4gIHRoaXMub3B0aW9ucy5saXZlID0gdHJ1ZTtcblxuICBpZiAodGhpcy5ub3RTdGFydGVkWWV0KCkpIHtcbiAgICAvLyBjb25zb2xlLmxvZyhgbm90IHN0YXJ0ZWRgKTtcbiAgICB0aGlzLm9wdGlvbnMudGljayA9IGZhbHNlO1xuICAgIHRoaXMub3B0aW9ucy5saXZlID0gZmFsc2U7XG5cbiAgICB0aGlzLmhpZGVBc3NvY2lhdGUoXCJub3Qtc3RhcnRlZFwiKTtcbiAgICB0aGlzLmhpZGUoKTtcbiAgfSBlbHNlIGlmICh0aGlzLmxpbWl0UmVhY2hlZCgpKSB7XG4gICAgLy8gY29uc29sZS5sb2coYGVuZGVkYCk7XG4gICAgdGhpcy5vcHRpb25zLnRpY2sgPSBmYWxzZTtcbiAgICB0aGlzLm9wdGlvbnMuZW5kZWQgPSB0cnVlO1xuXG4gICAgdGhpcy5oaWRlT25FbmQoKTtcbiAgfVxufTtcblxuQ2xvY2tDb21wb25lbnQucHJvdG90eXBlLmluaXRGcmFnbWVudHMgPSBmdW5jdGlvbiAoKSB7XG4gIHRoaXMuZnJhZ21lbnRzID0ge1xuICAgIGQ6IHRoaXMucm9vdC5xdWVyeVNlbGVjdG9yKFwiLmJlb24tY2xvY2tfX2ZyYWdtZW50LWQsIC5ibi1jbG9ja19fZnJhZy1kXCIpLFxuICAgIEg6IHRoaXMucm9vdC5xdWVyeVNlbGVjdG9yKFwiLmJlb24tY2xvY2tfX2ZyYWdtZW50LUgsIC5ibi1jbG9ja19fZnJhZy1IXCIpLFxuICAgIGk6IHRoaXMucm9vdC5xdWVyeVNlbGVjdG9yKFwiLmJlb24tY2xvY2tfX2ZyYWdtZW50LWksIC5ibi1jbG9ja19fZnJhZy1pXCIpLFxuICAgIHM6IHRoaXMucm9vdC5xdWVyeVNlbGVjdG9yKFwiLmJlb24tY2xvY2tfX2ZyYWdtZW50LXMsIC5ibi1jbG9ja19fZnJhZy1zXCIpLFxuICB9O1xuXG4gIGlmICh0aGlzLmNvbmZpZy5hZ2dyZWdhdGVEYXlzKSB7XG4gICAgZG9tLmFkZENsYXNzKHRoaXMucm9vdCwgXCJiZW9uLWNsb2NrLS13aXRob3V0LWRheXNcIik7XG4gICAgdGhpcy5mcmFnbWVudHMuZC5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG4gIH1cbn07XG5cbkNsb2NrQ29tcG9uZW50LnByb3RvdHlwZS5pbml0Q2xvY2sgPSBmdW5jdGlvbiAoKSB7XG4gIHRoaXMudXBkYXRlRnJhZ21lbnRzKCk7XG59O1xuXG4vKipcbiAqIFRpbWUgY29udHJvbFxuICovXG5cbi8vIGRpZmYgbm93IGFuZCBlbmRcbkNsb2NrQ29tcG9uZW50LnByb3RvdHlwZS5kaWZmID0gZnVuY3Rpb24gKGQxLCBkMikge1xuICB2YXIgbWlsaXNlY29uZHMsIHNlY29uZHMsIGRpZmY7XG5cbiAgZGlmZiA9IHsgZDogMCwgSDogMCwgaTogMCwgczogMCB9O1xuXG4gIGlmICh0aGlzLmxpbWl0UmVhY2hlZCgpKSB7XG4gICAgdGhpcy5lbmQoKTtcbiAgICB0aGlzLmRhdGVzLmRpZmYgPSBkaWZmO1xuXG4gICAgcmV0dXJuIGRpZmY7XG4gIH1cblxuICBtaWxpc2Vjb25kcyA9IGQxLmdldFRpbWUoKSAtIGQyLmdldFRpbWUoKTtcblxuICBpZiAobWlsaXNlY29uZHMgPiAwKSB7XG4gICAgc2Vjb25kcyA9IG1pbGlzZWNvbmRzIC8gMTAwMDtcbiAgICBkaWZmLmQgPSBNYXRoLmZsb29yKHNlY29uZHMgLyA4NjQwMCk7XG4gICAgZGlmZi5IID0gTWF0aC5mbG9vcigoc2Vjb25kcyAtIGRpZmYuZCAqIDg2NDAwKSAvIDM2MDApO1xuICAgIGRpZmYuaSA9IE1hdGguZmxvb3IoKHNlY29uZHMgLSBkaWZmLmQgKiA4NjQwMCAtIGRpZmYuSCAqIDM2MDApIC8gNjApO1xuICAgIGRpZmYucyA9IE1hdGguZmxvb3Ioc2Vjb25kcyAtIGRpZmYuZCAqIDg2NDAwIC0gZGlmZi5IICogMzYwMCAtIGRpZmYuaSAqIDYwKTtcblxuICAgIGlmICh0aGlzLmNvbmZpZy5hZ2dyZWdhdGVEYXlzKSB7XG4gICAgICBkaWZmLkggPSBkaWZmLkggKyBkaWZmLmQgKiAyNDtcbiAgICAgIGRpZmYuZCA9IDA7XG4gICAgfVxuICB9XG5cbiAgdGhpcy5kYXRlcy5kaWZmID0gZGlmZjtcblxuICByZXR1cm4gZGlmZjtcbn07XG5cbkNsb2NrQ29tcG9uZW50LnByb3RvdHlwZS5ub3RTdGFydGVkWWV0ID0gZnVuY3Rpb24gKCkge1xuICAvLyB3YWxrIG5vdyAxMDAgbWlsbGlzZWNvbmRzIHRvIHByZXZlbnQgbWljcm9zZWNvbmQgYnVnXG4gIHZhciBub3cgPSB0aGlzLmRhdGVzLm5vdy5nZXRUaW1lKCkgLyAxMDAwICsgMTAwO1xuICB2YXIgc3RhcnQgPSB0aGlzLmRhdGVzLnN0YXJ0LmdldFRpbWUoKSAvIDEwMDA7XG5cbiAgcmV0dXJuIHN0YXJ0ID4gbm93O1xufTtcblxuQ2xvY2tDb21wb25lbnQucHJvdG90eXBlLmxpbWl0UmVhY2hlZCA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIG5vdyA9IHRoaXMuZGF0ZXMubm93LmdldFRpbWUoKTtcbiAgdmFyIGVuZCA9IHRoaXMuZGF0ZXMuZW5kLmdldFRpbWUoKTtcblxuICByZXR1cm4gbm93ID4gZW5kO1xufTtcblxuQ2xvY2tDb21wb25lbnQucHJvdG90eXBlLnVwZGF0ZU5vdyA9IGZ1bmN0aW9uICgpIHtcbiAgdGhpcy5kYXRlcy5ub3cgPSBuZXcgRGF0ZSgpO1xufTtcblxuQ2xvY2tDb21wb25lbnQucHJvdG90eXBlLnVyZ2VudFJlYWNoZWQgPSBmdW5jdGlvbiAoKSB7XG4gIGlmICh0aGlzLmRhdGVzLnVyZ2VudCkge1xuICAgIHZhciBub3cgPSB0aGlzLmRhdGVzLm5vdy5nZXRUaW1lKCk7XG4gICAgdmFyIHVyZ2VudCA9IHRoaXMuZGF0ZXMudXJnZW50LmdldFRpbWUoKTtcblxuICAgIHJldHVybiBub3cgPiB1cmdlbnQ7XG4gIH1cblxuICByZXR1cm4gMDtcbn07XG5cbi8qKlxuICogQ2xvY2sgY29udHJvbFxuICovXG5cbkNsb2NrQ29tcG9uZW50LnByb3RvdHlwZS51cGRhdGVGcmFnbWVudHMgPSBmdW5jdGlvbiAoKSB7XG4gIHZhciBkaWZmID0gT2JqZWN0LmVudHJpZXModGhpcy5kaWZmKHRoaXMuZGF0ZXMuZW5kLCB0aGlzLmRhdGVzLm5vdykpO1xuXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgZGlmZi5sZW5ndGg7IGkrKykge1xuICAgIHZhciBbZnJhZywgdmFsdWVdID0gZGlmZltpXTtcbiAgICB0aGlzLnNldEZyYWdtZW50KGZyYWcsIHZhbHVlKTtcbiAgfVxufTtcblxuQ2xvY2tDb21wb25lbnQucHJvdG90eXBlLnNldEZyYWdtZW50ID0gZnVuY3Rpb24gKGZyYWcsIHZhbHVlKSB7XG4gIHZhciBmb3JtYXR0ZWQ7XG5cbiAgaWYgKFxuICAgICh0aGlzLmNvbmZpZy5hZ2dyZWdhdGVEYXlzICYmIGZyYWcgPT09IFwiSFwiKSB8fFxuICAgICghdGhpcy5jb25maWcuYWdncmVnYXRlRGF5cyAmJiBmcmFnID09PSBcImRcIilcbiAgKSB7XG4gICAgZm9ybWF0dGVkID0gdmFsdWUudG9TdHJpbmcoKS5sZW5ndGggPD0gMiA/IHRoaXMucGFkKHZhbHVlLCAyLCBcIjBcIikgOiB2YWx1ZTtcbiAgfSBlbHNlIHtcbiAgICBmb3JtYXR0ZWQgPSB0aGlzLnBhZCh2YWx1ZSwgMiwgXCIwXCIpO1xuICB9XG5cbiAgdGhpcy5mcmFnbWVudHNbZnJhZ10uaW5uZXJUZXh0ID0gZm9ybWF0dGVkO1xufTtcblxuQ2xvY2tDb21wb25lbnQucHJvdG90eXBlLnRpY2sgPSBmdW5jdGlvbiAoKSB7XG4gIGlmICghdGhpcy5vcHRpb25zLnRpY2spIHtcbiAgICByZXR1cm4gdGhpcy5zdG9wKCk7XG4gIH1cblxuICB0aGlzLnVwZGF0ZU5vdygpO1xuICB0aGlzLnVwZGF0ZUZyYWdtZW50cygpO1xuXG4gIGlmICghdGhpcy5vcHRpb25zLnVyZ2VudCAmJiB0aGlzLnVyZ2VudFJlYWNoZWQoKSkge1xuICAgIHRoaXMudXJnZW50KCk7XG4gIH1cblxuICBpZiAodGhpcy5saW1pdFJlYWNoZWQoKSkge1xuICAgIHRoaXMuZW5kKCk7XG4gIH1cbn07XG5cbkNsb2NrQ29tcG9uZW50LnByb3RvdHlwZS5zdGFydCA9IGZ1bmN0aW9uICgpIHtcbiAgaWYgKCF0aGlzLm9wdGlvbnMubGl2ZSkge1xuICAgIHJldHVybiB0aGlzLnN0b3AoKTtcbiAgfVxuXG4gIHRoaXMuaW50ZXJ2YWwgPSB3aW5kb3cuc2V0SW50ZXJ2YWwodGhpcy50aWNrLmJpbmQodGhpcyksIDEwMDApO1xuICB0aGlzLm9wdGlvbnMudGljayA9IHRydWU7XG59O1xuXG5DbG9ja0NvbXBvbmVudC5wcm90b3R5cGUuc3RvcCA9IGZ1bmN0aW9uICgpIHtcbiAgd2luZG93LmNsZWFySW50ZXJ2YWwodGhpcy5pbnRlcnZhbCk7XG4gIHRoaXMub3B0aW9ucy50aWNrID0gZmFsc2U7XG59O1xuXG5DbG9ja0NvbXBvbmVudC5wcm90b3R5cGUuZW5kID0gZnVuY3Rpb24gKCkge1xuICB0aGlzLnN0b3AoKTtcbiAgdGhpcy5lbmRlZCA9IHRydWU7XG4gIGRvbS5hZGRDbGFzcyh0aGlzLnJvb3QsIFwiZW5kZWRcIik7XG5cbiAgdGhpcy5oaWRlT25FbmQoKTtcbn07XG5cbkNsb2NrQ29tcG9uZW50LnByb3RvdHlwZS51cmdlbnQgPSBmdW5jdGlvbiAoKSB7XG4gIHRoaXMub3B0aW9ucy51cmdlbnQgPSB0cnVlO1xuICBkb20uYWRkQ2xhc3ModGhpcy5yb290LCBcInVyZ2VudFwiKTtcbn07XG5cbkNsb2NrQ29tcG9uZW50LnByb3RvdHlwZS5oaWRlT25FbmQgPSBmdW5jdGlvbiAoKSB7XG4gIGlmICh0aGlzLmVuZGVkICYmIHRoaXMuY29uZmlnLmhpZGVPbkVuZCkge1xuICAgIHRoaXMuaGlkZUFzc29jaWF0ZShcImVuZGVkXCIpO1xuICAgIHRoaXMuaGlkZSgpO1xuICAgIGRvbS5hZGRDbGFzcyh0aGlzLnJvb3QsIFwiYm4tLWNsb2NrLWVuZGVkXCIpO1xuICB9XG59O1xuXG4vLyBjbG9jayBhc3NvY2lhdGUgZWxlbWVudHNcbkNsb2NrQ29tcG9uZW50LnByb3RvdHlwZS5nZXRBc3NvY2lhdGUgPSBmdW5jdGlvbiAoKSB7XG4gIHZhciBhc3NvY2lhdGVJZCA9IHRoaXMucm9vdC5nZXRBdHRyaWJ1dGUoXCJkYXRhLWFzc29jaWF0ZS1pZFwiKTtcbiAgdmFyIGFzc29jaWF0ZUVsID0gYXNzb2NpYXRlSWQgPyBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChhc3NvY2lhdGVJZCkgOiBudWxsO1xuXG4gIHRoaXMuYXNzb2NpYXRlID0gYXNzb2NpYXRlRWw7XG5cbiAgcmV0dXJuIHRoaXMuYXNzb2NpYXRlO1xufTtcblxuQ2xvY2tDb21wb25lbnQucHJvdG90eXBlLmhhc0Fzc29jaWF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgdGhpcy5nZXRBc3NvY2lhdGUoKTtcbiAgcmV0dXJuIHRoaXMuYXNzb2NpYXRlID8gdHJ1ZSA6IGZhbHNlO1xufTtcblxuQ2xvY2tDb21wb25lbnQucHJvdG90eXBlLmhpZGVBc3NvY2lhdGUgPSBmdW5jdGlvbiAocmVhc29uKSB7XG4gIHZhciByZWFzb24gPSByZWFzb24gfHwgXCJub3Qtc3RhcnRlZFwiO1xuXG4gIGlmICh0aGlzLmhhc0Fzc29jaWF0ZSgpKSB7XG4gICAgdGhpcy5oaWRlKHRoaXMuZ2V0QXNzb2NpYXRlKCkpO1xuICAgIGRvbS5hZGRDbGFzcyh0aGlzLmdldEFzc29jaWF0ZSgpLCBcImJuLS1jbG9jay1cIiArIHJlYXNvbik7XG4gIH1cbn07XG5cbkNsb2NrQ29tcG9uZW50LnByb3RvdHlwZS5oaWRlID0gZnVuY3Rpb24gKGVsKSB7XG4gIHZhciBlbFRvSGlkZSA9IGVsIHx8IHRoaXMucm9vdDtcbiAgZG9tLmRpc3BsYXkoZWxUb0hpZGUsIFwibm9uZVwiKTtcbn07XG5cbi8qKlxuICogdXRpbHNcbiAqL1xuXG5DbG9ja0NvbXBvbmVudC5wcm90b3R5cGUucGFkID0gZnVuY3Rpb24gKHN0ciwgc2l6ZSwgcGFkZGluZykge1xuICBzaXplID0gc3RyLmxlbmd0aCA+IHNpemUgPyBzdHIucGVuZ3RoIDogc2l6ZTtcbiAgc3RyID0gcGFkZGluZy5yZXBlYXQoc2l6ZSkgKyBzdHI7XG5cbiAgcmV0dXJuIHN0ci5zdWJzdHIoc3RyLmxlbmd0aCAtIHNpemUpO1xufTtcblxuZXhwb3J0IGRlZmF1bHQgQ2xvY2tDb21wb25lbnQ7XG4iLCJcInVzZSBzdHJpY3RcIjtcblxuLy8gdmFyIHNsaWRlciA9IHJlcXVpcmUoXCIuL3NsaWRlclwiKTtcbmltcG9ydCBDbG9ja0NvbXBvbmVudCBmcm9tIFwiLi9jbG9ja1wiO1xuXG52YXIgQ2xvY2tJbml0aWFsaXplciA9IGZ1bmN0aW9uICgpIHtcbiAgdGhpcy5jb21wb25lbnRSb290U2VsZWN0b3IgPSBcIi5iZW9uLWNsb2NrXCI7XG5cbiAgLy8gaW5pdGlhbGl6ZSBzbGlkZXJzIGFscmVhZHkgb24gcGFnZVxuICB0aGlzLmluaXRDb21wb25lbnRzKCk7XG5cbiAgLy8gYmluZCBldmVudHMgdG8gaW5pdGlhbGl6ZSBzbGlkZXJzIHJlYWwgdGltZVxuICB0aGlzLmJpbmRFdmVudHMoKTtcbn07XG5cbmV4cG9ydCBkZWZhdWx0IENsb2NrSW5pdGlhbGl6ZXI7XG5cbkNsb2NrSW5pdGlhbGl6ZXIucHJvdG90eXBlLmJpbmRFdmVudHMgPSBmdW5jdGlvbiAoKSB7XG4gIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJET01Db250ZW50TG9hZGVkXCIsIHRoaXMuaW5pdENvbXBvbmVudHMuYmluZCh0aGlzKSk7XG4gIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXG4gICAgXCJiZW9uLmJ1ZGR5LmVsZW1lbnRzLmhhbmRsZS5pdGVtLmluamVjdC5zdWNjZXNzXCIsXG4gICAgdGhpcy5pbml0Q29tcG9uZW50RnJvbUluamVjdGlvbi5iaW5kKHRoaXMpXG4gICk7XG4gIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXG4gICAgXCJiZW9uLmJ1ZGR5LmluamVjdC5hZnRlclwiLFxuICAgIHRoaXMuaW5pdENvbXBvbmVudEZyb21JbmplY3Rpb24uYmluZCh0aGlzKVxuICApO1xufTtcblxuQ2xvY2tJbml0aWFsaXplci5wcm90b3R5cGUuaW5pdENvbXBvbmVudHMgPSBmdW5jdGlvbiAoKSB7XG4gIHZhciBjb21wb25lbnRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcbiAgICB0aGlzLmNvbXBvbmVudFJvb3RTZWxlY3RvciArIFwiOm5vdCguaW5pdGlhbGl6ZWQpXCJcbiAgKTtcblxuICBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChjb21wb25lbnRzKS5mb3JFYWNoKFxuICAgIGZ1bmN0aW9uIChyb290KSB7XG4gICAgICB0aGlzLmluaXRDb21wb25lbnQocm9vdCk7XG4gICAgfS5iaW5kKHRoaXMpXG4gICk7XG59O1xuXG5DbG9ja0luaXRpYWxpemVyLnByb3RvdHlwZS5pbml0Q29tcG9uZW50RnJvbUluamVjdGlvbiA9IGZ1bmN0aW9uIChldmVudCkge1xuICB2YXIgY29udGFpbmVyID0gZXZlbnQuZGV0YWlsLmNvbnRhaW5lcjtcbiAgdmFyIHJvb3QgPSBjb250YWluZXIucXVlcnlTZWxlY3RvcihcbiAgICB0aGlzLmNvbXBvbmVudFJvb3RTZWxlY3RvciArIFwiOm5vdCguaW5pdGlhbGl6ZWQpXCJcbiAgKTtcblxuICBpZiAocm9vdCkge1xuICAgIGlmIChkb2N1bWVudC5yZWFkeVN0YXRlID09PSBcImxvYWRpbmdcIikge1xuICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcbiAgICAgICAgXCJET01Db250ZW50TG9hZGVkXCIsXG4gICAgICAgIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICB0aGlzLmluaXRDb21wb25lbnQocm9vdCk7XG4gICAgICAgIH0uYmluZCh0aGlzKVxuICAgICAgKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5pbml0Q29tcG9uZW50KHJvb3QpO1xuICAgIH1cbiAgfVxufTtcblxuQ2xvY2tJbml0aWFsaXplci5wcm90b3R5cGUuaW5pdENvbXBvbmVudCA9IGZ1bmN0aW9uIChyb290KSB7XG4gIHRyeSB7XG4gICAgd2luZG93LmJlb25faW5pdF9sb2cgPSB3aW5kb3cuYmVvbl9pbml0X2xvZyB8fCBbXTtcblxuICAgIHZhciByYXdDb25maWcgPSByb290LmdldEF0dHJpYnV0ZShcImRhdGEtY29uZmlnXCIpO1xuICAgIHZhciByb290SWQgPSByb290LmlkO1xuICAgIHZhciBjb25maWcgPSBKU09OLnBhcnNlKHJhd0NvbmZpZyk7XG5cbiAgICAvLyBpZiAod2luZG93LmJlb25faW5pdF9sb2cuaW5kZXhPZihyb290SWQpID4gLTEpIHtcbiAgICAvLyAgIGNvbnNvbGUubG9nKFwiY2xvY2sgYWxyZWFkeSBpbml0aWFsaXplZCBcIiArIHJvb3RJZCk7XG4gICAgLy8gICByZXR1cm47XG4gICAgLy8gfVxuXG4gICAgLy8gd2luZG93LmJlb25faW5pdF9sb2cucHVzaChyb290SWQpO1xuXG4gICAgbmV3IENsb2NrQ29tcG9uZW50KHJvb3QsIGNvbmZpZyk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBjb25zb2xlLmxvZyhcImZhaWxlZCB0byBidWlsZCBjb21wb25lbnQgXCIgKyB0aGlzLmNvbXBvbmVudFJvb3RTZWxlY3RvciwgZSk7XG4gIH1cbn07XG5cbihmdW5jdGlvbiAoKSB7XG4gIGlmICh3aW5kb3cpIHdpbmRvdy5CZW9uQ2xvY2tJbml0aWFsaXplciA9IENsb2NrSW5pdGlhbGl6ZXI7XG59KSgpO1xuIl0sInNvdXJjZVJvb3QiOiIifQ==